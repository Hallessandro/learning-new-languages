<!doctype html>
<html>

<head>  
  <title>
    
      #4 - Introdução ao Meteor - Parte 2 | Hallessandro' Adventures
    
  </title>
    
    <meta property="og:image" content="/assets/img/coverPosts/meteor2.png" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">
  <!-- Use Atom -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Hallessandro' Adventures" />
  <!-- Use RSS-2.0 -->
  <!--<link href="/rss-feed.xml" type="application/rss+xml" rel="alternate" title="Hallessandro' Adventures | Developed with Jekyll and Github Pages"/>
  //-->

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quattrocento+Sans">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <!-- Google Analytics -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-112060364-1', 'auto');
  ga('send', 'pageview');
</script>


  <!-- Use Jekyll SEO plugin -->
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>#4 - Introdução ao Meteor - Parte 2 | Hallessandro’ Adventures</title>
<meta name="generator" content="Jekyll v3.6.3" />
<meta property="og:title" content="#4 - Introdução ao Meteor - Parte 2" />
<meta name="author" content="Hallessandro D´villa" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Olá terráqueos, no primeiro post sobre Meteor, que você pode encontrar aqui, vimos como construir uma aplicação Meteor de cadastro de livros. Atualmente a aplicação permite o cadastro de novos livros além de exibir os livros já existente. Nesse post vamos aprimorar essa aplicação, permitindo agora a edição e remoção dos livros presentes na lista." />
<meta property="og:description" content="Olá terráqueos, no primeiro post sobre Meteor, que você pode encontrar aqui, vimos como construir uma aplicação Meteor de cadastro de livros. Atualmente a aplicação permite o cadastro de novos livros além de exibir os livros já existente. Nesse post vamos aprimorar essa aplicação, permitindo agora a edição e remoção dos livros presentes na lista." />
<link rel="canonical" href="http://localhost:4000/programming/introducao-meteor-parte2.html" />
<meta property="og:url" content="http://localhost:4000/programming/introducao-meteor-parte2.html" />
<meta property="og:site_name" content="Hallessandro’ Adventures" />
<meta property="og:image" content="http://localhost:4000/coverPosts/meteor2.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-06-06T00:00:00-03:00" />
<script type="application/ld+json">
{"headline":"#4 - Introdução ao Meteor - Parte 2","dateModified":"2018-06-06T00:00:00-03:00","datePublished":"2018-06-06T00:00:00-03:00","@type":"BlogPosting","image":"http://localhost:4000/coverPosts/meteor2.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/programming/introducao-meteor-parte2.html"},"url":"http://localhost:4000/programming/introducao-meteor-parte2.html","author":{"@type":"Person","name":"Hallessandro D´villa"},"description":"Olá terráqueos, no primeiro post sobre Meteor, que você pode encontrar aqui, vimos como construir uma aplicação Meteor de cadastro de livros. Atualmente a aplicação permite o cadastro de novos livros além de exibir os livros já existente. Nesse post vamos aprimorar essa aplicação, permitindo agora a edição e remoção dos livros presentes na lista.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>


<body>

  <div class="container">
    <header class="masthead">
  <h3 class="masthead-title">
    <a href="/">Hallessandro' Adventures</a>
    <!-- <small class="masthead-subtitle">Developed with Jekyll and Github Pages</small>-->
    <div class="menu">
  <nav class="menu-content">
    
      <a href="/menu/about.html">About</a>
    
      <a href="/menu/writing.html">Posts</a>
    
      <a href="/menu/contact.html">Contact</a>
    
  </nav>
  <nav class="social-icons">
    
  
  
    <a href="https://github.com/Hallessandro" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
  

  
  
    <a href="https://twitter.com/_MrDvilla" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
  

  
  
    <a href="https://www.linkedin.com/in/hallessandro/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
  

  
  
    <a href="https://www.facebook.com/hallessandro.dvilla" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
  

  
  
    <a href="mailto:hd.jesus93@gmail.com" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  

  
  
    <a href="/feed.xml"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
  

  </nav>
</div>

  </h3>
</header>


    <div class="post-container">
      <h1>
  #4 - Introdução ao Meteor - Parte 2
</h1>


  <img src="/assets/img/coverPosts/meteor2.png">


<p>Olá terráqueos, no primeiro post sobre  Meteor, que você pode encontrar <a href="https://hallessandro.github.io/programmi/introducao-meteor.html">aqui</a>, vimos como construir uma aplicação Meteor de cadastro de livros. Atualmente a aplicação permite o cadastro de novos livros além de exibir os livros já existente. Nesse post vamos aprimorar essa aplicação, permitindo agora a edição e remoção dos livros presentes na lista.</p>

<blockquote>
  <p>Talvez você tenha notado que tanto neste post quanto na primeira parte, alguns códigos demonstrados são imagens, enquanto que outros são em blocos de código mesmo, isso ocorre haja vista que o Markdown não renderiza os códigos que estão entre chaves, como por exemplo , por esse motivo todos os blocos de código que em alguma parte utilizem código entre chaves, estão sendo exibidos em forma de imagem.</p>
</blockquote>

<p>Para começar, vamos atualizar o template de lista, adicionando dois botões, um para editar e outro para remover. Além disso vamos atualizar a forma como os dados são apresentados de uma lista para uma tabela, apenas para deixar as coisas um pouco mais organizadas.</p>

<p><img src="../assets/img/Post2Meteor/code1.png" alt="Código do template de lista.html" /></p>

<p>Se você se lembra do primeiro post, para adicionar um novo livro a gente tratou o evento de submit do form em novo.js, fazendo com que ele resultasse na adição do novo livro. Vamos realizar esse mesmo tipo de tratamento para os nossos novos botões, começando pelo de remover, para isso altere o arquivo lista.js deixando o desta forma:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Template</span><span class="p">.</span><span class="nx">lista</span><span class="p">.</span><span class="nx">helpers</span><span class="p">({</span>
	<span class="na">livros</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">Livros</span><span class="p">.</span><span class="nx">find</span><span class="p">({});</span>
	<span class="p">}</span>
<span class="p">});</span>
<span class="nx">Template</span><span class="p">.</span><span class="nx">lista</span><span class="p">.</span><span class="nx">events</span><span class="p">({</span>
    <span class="s2">"click button"</span> <span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">template</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">livro</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> 
            <span class="nx">Livros</span><span class="p">.</span><span class="nx">remove</span><span class="p">({</span><span class="na">_id</span><span class="p">:</span> <span class="nx">livro</span><span class="p">.</span><span class="nx">_id</span><span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Teste a execução do código acima e veja o resultado, clique em ambos os botões. Se tudo ocorreu como deveria você deve ter notado que existe um comportamento nada desejado com nossos botões, tanto o de editar quanto o de remover estão removendo o registro, e definitivamente não é isso que desejamos. Isso ocorre pois estamos capturando o evento de “click button” ou seja, clique do botão, mas em nenhum momento falamos para o Meteor qual o botão, assim quando qualquer botão existente na página for clicado, ele vai disparar o evento.</p>

<p>Para resolver isso vamos adicionar uma classe em cada um dos nossos botões:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"editar"</span><span class="nt">&gt;</span>Editar<span class="nt">&lt;/button&gt;</span>
	<span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"remover"</span><span class="nt">&gt;</span>Remover<span class="nt">&lt;/button&gt;</span>
</code></pre></div></div>

<p>Agora em lista.js ao invés de capturar apenas o evento de clique vamos capturar o evento de clique para o botão que possui a classe remover. Isso vai resolver o problema limitando que a ação só ocorra quando o botão possuir a classe correta.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Template</span><span class="p">.</span><span class="nx">lista</span><span class="p">.</span><span class="nx">events</span><span class="p">({</span>
    <span class="s2">"click button .remover"</span> <span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">template</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">livro</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> 
            <span class="nx">Livros</span><span class="p">.</span><span class="nx">remove</span><span class="p">({</span><span class="na">_id</span><span class="p">:</span> <span class="nx">livro</span><span class="p">.</span><span class="nx">_id</span><span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>
<p>Agora vamos implementar o evento que vai responder ao botão de editar, para isso em lista.js adicione o código abaixo:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//Código anterior omitido </span>
<span class="s2">"click button .editar"</span> <span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">template</span><span class="p">){</span>
    <span class="kd">let</span> <span class="nx">livro</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span> 
    <span class="kd">let</span> <span class="nx">resultado</span> <span class="o">=</span> <span class="nx">Livros</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="nx">livro</span><span class="p">.</span><span class="nx">_id</span><span class="p">;});</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">resultado</span><span class="p">){</span>
        <span class="kd">let</span> <span class="nx">inputNome</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#livro"</span><span class="p">);</span>
        <span class="nx">inputNome</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="nx">resultado</span><span class="p">.</span><span class="nx">nome</span><span class="p">);</span>
        <span class="kd">let</span> <span class="nx">inputIdLivro</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#id"</span><span class="p">);</span> <span class="c1">//Esse vai ser um input hidden</span>
        <span class="nx">inputIdLivro</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="nx">livro</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<blockquote>
  <p>O findOne() utilizado, retorna apenas um documento que satisfaça a condição passada na consulta, por mais que haja outros resultados ele vai retornar apenas o primeiro, diferente do find() que pode retornar vários resultados, dependendo das condições passadas na consulta.</p>
</blockquote>

<p>Agora quando clicado no botão de editar, o input que possui o nome do livro vai ser preenchido com o valor do livro que estamos editando, porém talvez você tenha reparado que estamos passando o _id do livro para um input no template, porém esse campo não existe, vamos resolver isso agora.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">name=</span><span class="s">"novo"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form&gt;</span>
        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"livro"</span><span class="nt">&gt;</span>Livro<span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">id=</span><span class="s">"livro"</span> <span class="na">name=</span><span class="s">"livro"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Cadastrar"</span><span class="nt">&gt;</span>

        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"id"</span> <span class="na">id=</span><span class="s">"id"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre></div></div>
<p>Repare que o input é do tipo hidden, isso pois não queremos que o usuário digite valores para esse campo, ele vai receber algum valor apenas quando clicado no botão de editar. Vamos usar isso no evento que adiciona nosso livro no banco, alterando a forma como ele está implementado atualmente.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Template</span><span class="p">.</span><span class="nx">novo</span><span class="p">.</span><span class="nx">events</span><span class="p">({</span>
    <span class="s2">"submit form"</span> <span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">template</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
            <span class="kd">let</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#livro"</span><span class="p">);</span>
            <span class="kd">let</span> <span class="nx">nome</span> <span class="o">=</span> <span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">();</span>
            <span class="kd">let</span> <span class="nx">inputId</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#id"</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">inputId</span><span class="p">.</span><span class="nx">val</span><span class="p">()){</span>
                    <span class="nx">Livros</span><span class="p">.</span><span class="nx">update</span><span class="p">({</span><span class="na">_id</span><span class="p">:</span> <span class="nx">inputId</span><span class="p">.</span><span class="nx">val</span><span class="p">()},</span> <span class="p">{</span>
                            <span class="na">$set</span><span class="p">:</span> <span class="p">{</span><span class="na">nome</span><span class="p">:</span> <span class="nx">nome</span><span class="p">}</span>
                    <span class="p">});</span>
            <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
                    <span class="nx">Livros</span><span class="p">.</span><span class="nx">insert</span><span class="p">({</span><span class="na">nome</span><span class="p">:</span> <span class="nx">nome</span><span class="p">});</span>
            <span class="p">}</span>
            <span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="s2">""</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>
<p>Agora nossa função não vai ser responsável apenas por adicionar registros, mas também por atualizar os registros já existentes, e para que isso funcione ela precisa identificar o que deve fazer quando for acionada, por esse motivo o input do tipo hidden foi adicionado no template, assim sempre que esse campo possuir um valor, um update será executado ao invés do insert.</p>

<p>Com isso chegamos ao fim deste post, no próximo post vamos ver como melhorar nossa aplicação adicionando Bootstrap e um sistema de login, então até a próxima.</p>

<p><strong>Referências:</strong></p>

<ol>
  <li><a href="https://www.meteor.com/">Site oficial</a></li>
  <li><a href="https://www.youtube.com/watch?v=9494-2E4riQ">Build A Meteor.js App In 45 Minutes</a></li>
  <li><a href="https://www.youtube.com/watch?v=eOi3F6Kbl7E">What Is Meteor?</a></li>
  <li><a href="https://www.youtube.com/watch?v=6_8B3mi1m18">Why use meteor</a></li>
  <li><a href="https://www.alura.com.br/curso-online-meteorjs">Meteor: Crie single page applications com JavaScript</a></li>
  <li><a href="https://www.casadocodigo.com.br/products/livro-meteor">Criando aplicações web real-time com JavaScript</a></li>
  <li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.findOne/">db.collection.findOne()</a></li>
  <li><a href="https://docs.mongodb.com/manual/reference/method/db.collection.update/">db.collection.update()</a></li>
</ol>


<span class="post-date">
  Written on
  
  June
  6th,
  2018
  by
  
    Hallessandro D´villa
  
</span>

<div class="post-date">Feel free to share!</div>
  <div class="sharing-icons">
    <a href="https://twitter.com/intent/tweet?text=#4 - Introdução ao Meteor - Parte 2&amp;url=/programming/introducao-meteor-parte2.html" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
    <a href="https://www.facebook.com/sharer/sharer.php?u=/programming/introducao-meteor-parte2.html&amp;title=#4 - Introdução ao Meteor - Parte 2" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
    <a href="https://plus.google.com/share?url=/programming/introducao-meteor-parte2.html" target="_blank"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
  </div>
</div>


<div class="related">
  <h1 >You may also enjoy:</h1>
  
  <ul class="related-posts">
    
      
        
        
      
        
          <li>
            <h3>
              <a href="/programmi/introducao-meteor.html">
                #3 - Introdução ao Meteor
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>June 3, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
    
      
        
          <li>
            <h3>
              <a href="/programming,/javascript/array_concat.html">
                #17 - Quick Tip - Array.prototype.concat()
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>July 17, 2019</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
          <li>
            <h3>
              <a href="/programming/creating_charts_with_js.html">
                #15 - Creating charts with JavaScript using PlotlyJS
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>March 24, 2019</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
          <li>
            <h3>
              <a href="/programming/controlando_arduino_com_j5.html">
                #11 - Johnny Five - Controlling a Arduino Uno with JavaScript
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>December 1, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
    
      
        
          <li>
            <h3>
              <a href="/programming/api-rest-node.html">
                #6 - Construindo uma API REST com Node js
                <!--<img src="http://localhost:4000/images/">-->
                <!--<small>September 1, 2018</small>-->
              </a>
            </h3>
          </li>
          
        
      
        
        
      
        
        
      
    
      
        
        
      
        
        
      
    
  </ul>
</div>




    </div>

    <footer class="footer">
  
  
  
    <a href="https://github.com/Hallessandro" target="_blank"><i class="fa fa-github" aria-hidden="true"></i></a>
  

  
  
    <a href="https://twitter.com/_MrDvilla" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
  

  
  
    <a href="https://www.linkedin.com/in/hallessandro/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
  

  
  
    <a href="https://www.facebook.com/hallessandro.dvilla" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
  

  
  
    <a href="mailto:hd.jesus93@gmail.com" target="_blank"><i class="fa fa-envelope" aria-hidden="true"></i></a>
  

  
  
    <a href="/feed.xml"><i class="fa fa-rss-square" aria-hidden="true"></i></a>
  

  <div class="post-date"><a href="/menu/about.html">Developed with Jekyll and Github Pages by Hallessandro D´villa</a></div>
</footer>

  </div>

</body>
</html>
